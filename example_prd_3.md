RecipeShare - Product Requirements Document

## 1) Summary

RecipeShare is a consumer-facing recipe sharing app for home cooks who want to find recipes by ingredient and build weekly meal plans with an autogenerated shopping list. Core value: quickly discover recipes that match available ingredients and convert planned meals into an actionable shopping list.

Assumption: Single-tenant consumer app with individual user accounts.
Assumption: Users will input recipe images as URL strings in V1 (no binary upload).
Assumption: All times and dates use user local timezone; meal plan dates are date-only (no time).
Assumption: Ingredient matching is exact match on normalized name (case-insensitive, whitespace-trimmed).
Assumption: No external recipe import or scraping in V1.
Assumption: Mobile-first design; desktop shows expanded layout.

## 2) Tech Stack

- Framework: Next.js 16 App Router with Turbopack
- Database: Supabase PostgreSQL
- Auth: Clerk (consumer accounts)
- Styling: Tailwind CSS + shadcn/ui
- Key libs: Zod (schema validation), React Hook Form (forms), Day.js (date handling)
- Deployment: Vercel

## 3) User Roles

- user (authenticated): create/read/update/delete own recipes; create/read/update/delete own meal plans; search public recipes; save recipes to personal collection.
- anonymous: read public recipes and search ingredients; cannot create meal plans or save recipes.
- admin: all user permissions plus can mark recipes as featured (internal flag).

Permissions summary:

- No role can edit another user's recipes except admin.
- Public recipes: by default, recipes created by users are public. Private flag optional; private recipes readable only by owner.

## 4) Data Model

Entity: user

- id: uuid (primary)
- email: string
- display_name: string, default ""
- created_at: timestamptz, default now()
- avatar_url: string, nullable

Entity: ingredient

- id: uuid (primary)
- name: string, unique (normalized lowercase), not null
- created_at: timestamptz, default now()

Entity: recipe

- id: uuid (primary)
- owner_id: uuid (foreign -> user.id), not null
- title: string, not null
- description: text, default ""
- servings: integer, default 1
- prep_minutes: integer, default 0
- cook_minutes: integer, default 0
- image_url: string, nullable (V1: must be an HTTP/HTTPS URL)
- is_public: boolean, default true
- created_at: timestamptz, default now()
- updated_at: timestamptz, default now()
- tags: string[] (array of tag strings), default []

Entity: recipe_ingredient

- id: uuid (primary)
- recipe_id: uuid (foreign -> recipe.id), not null
- ingredient_id: uuid (foreign -> ingredient.id), not null
- raw_text: string, not null (e.g., "1 cup chopped onion")
- quantity: float, nullable
- unit: string, nullable (e.g., "cup", "tbsp")
- order_index: integer, default 0

Unique constraint: (recipe_id, order_index)

Entity: meal_plan

- id: uuid (primary)
- owner_id: uuid (foreign -> user.id), not null
- title: string, default "Weekly Plan"
- start_date: date, not null
- end_date: date, not null
- created_at: timestamptz, default now()

Entity: meal_plan_item

- id: uuid (primary)
- meal_plan_id: uuid (foreign -> meal_plan.id), not null
- date: date, not null
- slot: enum("breakfast", "lunch", "dinner", "snack"), not null
- recipe_id: uuid (foreign -> recipe.id), nullable (user can add free-text)
- note: string, nullable
- created_at: timestamptz, default now()
- Unique constraint: (meal_plan_id, date, slot)

Entity: shopping_list_item

- id: uuid (primary)
- meal_plan_id: uuid (foreign -> meal_plan.id), not null
- ingredient_id: uuid (foreign -> ingredient.id), nullable (if not matched)
- name: string, not null
- quantity: float, nullable
- unit: string, nullable
- checked: boolean, default false

Relationships

- user 1:N recipe
- recipe 1:N recipe_ingredient -> ingredient N:1
- user 1:N meal_plan
- meal_plan 1:N meal_plan_item
- meal_plan 1:N shopping_list_item

Enums

- slot: ["breakfast", "lunch", "dinner", "snack"]

Indexing

- ingredient.name unique index
- recipe.title text index for search
- recipe_ingredient.ingredient_id index

## 5) Core Features

Feature: Ingredient Search

- User Flow:
  1. User types into search box labeled "Search ingredients or recipes".
  2. UI shows dropdown with two sections: "Ingredients" and "Recipes".
  3. Ingredient matches show up to 10 exact or prefix matches sorted alphabetically.
  4. User clicks an ingredient → executes filtered recipe list showing recipes that include that ingredient.
- UI Copy & Colors:
  - Search placeholder: "Search ingredients or recipes"
  - No results: show message "No ingredients or recipes found."
  - Search box border: #D1D5DB (tailwind gray-300); focused border: #2563EB
  - Highlight background for dropdown item hover: #EFF6FF
- Error & Empty States:
  - If search API fails: show inline error banner with text "Unable to search right now. Please try again." and a retry button labeled "Retry".
- Acceptance Checks:
  - ✓ Typing "tom" returns "tomato" in ingredients section when exists.
  - ✓ Clicking an ingredient filters recipe list to only recipes that reference that ingredient.

Feature: Recipe View & Create

- User Flow (create):
  1. User clicks button "Create Recipe" (visible only to authenticated users).
  2. Form fields: Title, Description, Servings (number), Prep minutes (number), Cook minutes (number), Image URL, Tags (comma separated), Ingredients (repeating fields each with Ingredient name autocomplete and Raw text), Instructions (textarea).
  3. User fills and clicks primary button "Save Recipe".
  4. On success, show toast "Recipe saved" and redirect to recipe page.
- UI Copy & Colors:
  - Create button label: "Create Recipe" (#FFFFFF text on #2563EB background).
  - Primary form button: background #2563EB, hover #1D4ED8, text #FFFFFF.
  - Secondary button: "Cancel" with background #F3F4F6, border #D1D5DB, text #374151.
  - Toast success background: #DCFCE7, text #064E3B.
  - Form field labels: 14px, text color #111827.
- Error & Empty States:
  - Validation errors inline: e.g., for Title empty show "Title is required."
  - If image URL is invalid (non-HTTP/HTTPS): show "Image must be a valid URL starting with http:// or https://".
  - If save API fails: show modal with title "Could not save recipe" and body "There was a problem saving your recipe. Try again." Buttons: "Close" and "Retry".
- Acceptance Checks:
  - ✓ Required validation prevents saving if Title is empty and shows "Title is required."
  - ✓ Saving persists recipe data and redirects to recipe detail page with title visible.

Feature: Recipe Detail

- User Flow:
  1. User opens a recipe page via list or direct URL.
  2. Page shows image, title, tags, servings, prep/cook times, ingredients list with each ingredient clickable (navigates to ingredient-filtered recipe list), and instructions.
  3. Authenticated user sees "Add to Meal Plan" button.
- UI Copy & Colors:
  - Add to Meal Plan button: label "Add to Meal Plan", background #10B981, hover #059669, text #FFFFFF.
  - Ingredients header: "Ingredients" (H3 18px).
  - Instructions header: "Instructions".
- Error & Empty States:
  - If recipe not found: show page with headline "Recipe not found" and body "This recipe may have been removed." Button: "Back to recipes".
- Acceptance Checks:
  - ✓ Clicking an ingredient from the recipe navigates to filtered recipe list containing that ingredient.
  - ✓ "Add to Meal Plan" opens meal-plan picker modal.

Feature: Meal Planning (create/edit)

- User Flow (create a meal plan and add recipes):
  1. User navigates to "Meal Plans" page.
  2. User clicks "New Meal Plan".
  3. Modal form: Title (default "Weekly Plan"), Start date, End date (end_date must be >= start_date).
  4. User saves plan; app creates empty plan and redirects to meal plan detail.
  5. In meal plan detail, the user sees a date grid from start_date to end_date with 4 slots per day: Breakfast, Lunch, Dinner, Snack. Each slot shows an "Add" button if empty.
  6. User clicks "Add" → modal shows search box for recipes (title or ingredient). User selects a recipe → slot populated with recipe title and thumbnail. Optionally user adds a note. Click "Save".
  7. User can remove a recipe from a slot via "Remove" button and confirm "Remove from plan?" with buttons "Cancel" and "Remove".
  8. User clicks "Generate Shopping List" button to create shopping list for the plan.
- UI Copy & Colors:
  - New Meal Plan button: label "New Meal Plan", background #2563EB, text #FFFFFF.
  - Slot "Add" button: label "Add", background #F3F4F6, border #D1D5DB, text #374151.
  - Generate button: label "Generate Shopping List", background #111827, text #FFFFFF.
  - Confirm remove dialog danger button: background #DC2626, text #FFFFFF.
- Error & Empty States:
  - If end_date < start_date validation: show inline error "End date must be the same or later than Start date."
  - If plan has no items and user clicks "Generate Shopping List": show inline notice "No recipes in plan. Add at least one recipe to generate shopping list." and do not generate.
  - If meal plan API fails on save: show banner "Unable to save meal plan. Try again." with "Retry" button.
- Acceptance Checks:
  - ✓ User can create a meal plan with start and end dates and see a grid with date slots.
  - ✓ Adding a recipe to a slot persists and displays title and thumbnail in the slot.
  - ✓ Removing a recipe deletes the meal_plan_item and UI updates.

Feature: Shopping List Generation

- User Flow:
  1. User opens a meal plan and clicks "Generate Shopping List".
  2. Backend collects all recipe_ingredients for recipes in the plan, groups by normalized ingredient name, sums numeric quantities when unit matches exactly; otherwise creates separate line items.
  3. Shopping list page shows items with checkbox on left and quantity/unit and aggregated name.
  4. User can toggle checkbox; toggles persist per shopping_list_item.checked.
  5. User can manually add a shopping list item via "Add item" with fields Name, Quantity, Unit and "Add" button.
- UI Copy & Colors:
  - Shopping list title: "Shopping List for {Meal Plan Title}"
  - Generate button label: "Regenerate" (if shopping list exists)
  - Empty shopping list copy: "No items yet. Click 'Generate Shopping List' to build items from your meal plan."
  - Checkbox checked color: #10B981
- Error & Empty States:
  - If aggregation encounters mixed units preventing numeric sum: present two separate lines with note "(units differ; manual combine allowed)" displayed in smaller text #6B7280.
  - If generate API fails: show toast "Could not generate shopping list. Please try again."
- Acceptance Checks:
  - ✓ Generated shopping list contains aggregated items for same ingredient name.
  - ✓ Checking/unchecking item persists state and remains after page reload.

## 6) UI/UX

Color palette (5+ hex codes with usage)

- Primary: #2563EB (primary buttons, links)
- Primary hover: #1D4ED8 (primary button hover)
- Success: #10B981 (Add to Meal Plan button and checkbox checked)
- Danger: #DC2626 (delete/remove confirmations)
- Background: #FFFFFF (page background)
- Surface: #F9FAFB (cards and modals)
- Muted text: #6B7280 (secondary text)
- Strong text: #111827 (primary text)
- Border: #D1D5DB (inputs and dividers)
- Toast success bg: #DCFCE7 (success messages)

Typography

- Font family: Inter
- Base: 16px
- H1: 28px, semi-bold
- H2: 20px, medium
- H3: 18px, medium
- Body: 16px, regular
- Form labels: 14px, medium

Layout notes

- Mobile-first single-column flow.
- Header with search box fixed on top.
- Recipe lists: card grid (1 column mobile, 2 columns >= 768px).
- Meal plan detail: horizontal scrollable date tiles on mobile; 2-column overview on desktop.

## 7) Out of Scope (V1)

- Image binary upload and CDN management (only image URLs supported).
- Social features: likes, comments, follows, feeds.
- Recipe import from external sites or parsing of external recipe formats.
- Nutrition facts calculation or dietary filtering (keto, vegan) beyond tags.
- Collaborative multi-user meal plans (shared editing).
- Offline-first support or PWA caching.
- Unit conversion engine (only exact unit matches are summed).
- Advanced search ranking / AI recipe generation.

## 8) Success Criteria (Testable)

- ✓ Ingredient search returns matching ingredients and recipes; clicking an ingredient filters recipes.
- ✓ Authenticated users can create a recipe with validation; required fields block save and show specified messages.
- ✓ Recipe detail page displays ingredients, instructions, and "Add to Meal Plan" for authenticated users; clicking ingredient navigates to filtered list.
- ✓ Users can create a meal plan, add recipes into date/slot cells, remove them, and see UI updates and persisted state.
- ✓ Generating a shopping list aggregates ingredients by normalized name, displays items with checkboxes, allows manual addition, and persists checkbox state.
- ✓ All specified error states and empty states appear with exact copy when relevant (search failure, save failure, validation errors, empty shopping list).
- ✓ No console errors appear on main flows (recipe create, view, meal plan create, shopping list view) in a clean browser console.
