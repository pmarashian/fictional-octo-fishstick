{
  "project": "Clans",
  "branchName": "ralph/clans-mvp",
  "description": "Clans MVP - Mobile-first app for private, clan-based sharing with multi-clan posting, personalized names/emojis, and granular push notifications",
  "userStories": [
    {
      "id": "US-001",
      "title": "Initialize Next.js Backend Project",
      "description": "As a developer, I need a Next.js backend API project scaffolded so I have a foundation for all API endpoints.",
      "acceptanceCriteria": [
        "Next.js 14+ project created with App Router (API routes only)",
        "TypeScript configured",
        "Project runs locally with `npm run dev`",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Configure Redis Connection",
      "description": "As a developer, I need Redis client configured so I can store and retrieve data.",
      "acceptanceCriteria": [
        "Redis client library installed (redis)",
        "Connection module exports reusable Redis client",
        "Environment variables for Redis URL/credentials",
        "Connection test endpoint returns success",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Create Clans Hash Schema",
      "description": "As a developer, I need the Redis hash structure for clans so clan data can be stored.",
      "acceptanceCriteria": [
        "Helper functions for clan hash operations (create, get, update, delete)",
        "Schema: key `clan:{id}`, fields: name, description, owner_id, emoji, created_at",
        "Utility to generate unique clan IDs",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Create Clan Members Set Schema",
      "description": "As a developer, I need Redis sets for clan membership so I can track who belongs to each clan.",
      "acceptanceCriteria": [
        "Set key pattern: `clan_members:{clan_id}`",
        "Helper functions: addMember, removeMember, getMembers, isMember",
        "Hash for roles/permissions: `clan_member_roles:{clan_id}:{user_id}`",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Create User Clans Set Schema",
      "description": "As a developer, I need to track which clans a user belongs to for quick access.",
      "acceptanceCriteria": [
        "Set key pattern: `user_clans:{user_id}`",
        "Helper functions: addClan, removeClan, getUserClans",
        "Bidirectional sync with clan_members on join/leave",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Create Posts Hash Schema",
      "description": "As a developer, I need Redis hash structure for posts so content can be stored.",
      "acceptanceCriteria": [
        "Hash key pattern: `post:{id}`",
        "Fields: user_id, content (JSON), tags (array), clan_ids (array), created_at, posted_by, media_type",
        "Utility to generate unique post IDs",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Create Clan Feed Sorted Sets",
      "description": "As a developer, I need sorted sets for clan feeds so posts can be retrieved chronologically.",
      "acceptanceCriteria": [
        "Sorted set key pattern: `clan_feed:{clan_id}`",
        "Score: created_at timestamp, member: post_id",
        "Helper functions: addToFeed, getFeed (with pagination), removeFromFeed",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Create Date-Filtered Sorted Sets",
      "description": "As a developer, I need multiple sorted sets for date-filtered queries by user, clan, and media type.",
      "acceptanceCriteria": [
        "Sorted sets: `user_posts:{user_id}`, `type_posts:{media_type}`, `user_clan_posts:{user_id}:{clan_id}`",
        "All use created_at as score for range queries",
        "Helper for zrangebyscore with date range parameters",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Create Comments Data Structure",
      "description": "As a developer, I need Redis structure for comments with per-clan replication.",
      "acceptanceCriteria": [
        "Sorted set key pattern: `post_comments:{post_id}:{clan_id}`",
        "Comment hash: `comment:{id}` with user_id, text, created_at, post_id",
        "Helper to replicate comment across all post clan_ids",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Create Reactions Data Structure",
      "description": "As a developer, I need Redis hash for reactions with per-clan replication.",
      "acceptanceCriteria": [
        "Hash key pattern: `post_reactions:{post_id}:{clan_id}`",
        "Fields: `{user_id}:{emoji}`",
        "Helper to replicate reaction across all post clan_ids",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Create Notification Preferences Schema",
      "description": "As a developer, I need Redis hash for user notification preferences per clan.",
      "acceptanceCriteria": [
        "Hash key pattern: `user_prefs:{user_id}`",
        "Field: `clan:{clan_id}` with JSON value {posts, photos, tags, comments, reactions: bool}",
        "Default all true for new clan memberships",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Create User Clan Personalization Schema",
      "description": "As a developer, I need Redis hash for user-specific clan name/emoji overrides.",
      "acceptanceCriteria": [
        "Hash key pattern: `user_clan_personal:{user_id}:{clan_id}`",
        "Fields: name (override), emoji (override)",
        "Helper to get personalized or fallback to global",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Set Up S3 Media Storage",
      "description": "As a developer, I need S3 configured for photo/media uploads.",
      "acceptanceCriteria": [
        "S3 client configured with environment variables",
        "Presigned URL generation for uploads",
        "Presigned URL generation for downloads",
        "Typecheck passes"
      ],
      "priority": 13,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-014",
      "title": "Set Up Firebase Cloud Messaging",
      "description": "As a developer, I need FCM configured for push notifications.",
      "acceptanceCriteria": [
        "Firebase Admin SDK installed and configured",
        "FCM send function implemented",
        "Device token storage in Redis: `user_devices:{user_id}` (set)",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-015",
      "title": "Implement OAuth/Email Authentication",
      "description": "As a user, I want to sign up and log in so I can access the app securely.",
      "acceptanceCriteria": [
        "POST /api/auth/signup with email/password",
        "POST /api/auth/login returns JWT token",
        "User hash stored in Redis: `user:{id}`",
        "JWT middleware validates protected routes",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-016",
      "title": "Create Auth Middleware",
      "description": "As a developer, I need middleware to protect API routes requiring authentication.",
      "acceptanceCriteria": [
        "Middleware extracts and validates JWT from Authorization header",
        "Attaches user_id to request context",
        "Returns 401 for invalid/missing tokens",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-017",
      "title": "Create Clan API Endpoint",
      "description": "As a user, I want to create a clan so I can start a private sharing group.",
      "acceptanceCriteria": [
        "POST /api/clans accepts {name, description, emoji}",
        "Creates clan hash with owner_id from auth",
        "Adds owner to clan_members with admin role",
        "Adds clan to user_clans",
        "Returns clan_id",
        "Typecheck passes"
      ],
      "priority": 17,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-018",
      "title": "Get User's Clans Endpoint",
      "description": "As a user, I want to list my clans so I can see all groups I belong to.",
      "acceptanceCriteria": [
        "GET /api/clans returns all user's clans",
        "Includes personalized name/emoji if set",
        "Includes member count per clan",
        "Typecheck passes"
      ],
      "priority": 18,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-019",
      "title": "Get Single Clan Details Endpoint",
      "description": "As a user, I want to view clan details so I can see members and settings.",
      "acceptanceCriteria": [
        "GET /api/clans/{id} returns clan details",
        "Validates user is a member",
        "Includes member list with roles",
        "Includes personalized name/emoji for requesting user",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-020",
      "title": "Invite Members to Clan",
      "description": "As a clan owner, I want to invite members so they can join my clan.",
      "acceptanceCriteria": [
        "POST /api/clans/{id}/invite accepts {emails or user_ids}",
        "Only owner can invite",
        "Creates pending invites in Redis",
        "Limit: 50 members per clan enforced",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-021",
      "title": "Accept Clan Invitation",
      "description": "As a user, I want to accept an invitation so I can join a clan.",
      "acceptanceCriteria": [
        "POST /api/clans/{id}/join with invite token",
        "Adds user to clan_members with member role",
        "Adds clan to user_clans",
        "Sets default notification preferences (all true)",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-022",
      "title": "Leave Clan",
      "description": "As a clan member, I want to leave a clan so I'm no longer part of the group.",
      "acceptanceCriteria": [
        "POST /api/clans/{id}/leave",
        "Removes user from clan_members",
        "Removes clan from user_clans",
        "Owner cannot leave (must delete or transfer)",
        "Typecheck passes"
      ],
      "priority": 22,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-023",
      "title": "Remove Member from Clan",
      "description": "As a clan owner, I want to remove members so I can manage my group.",
      "acceptanceCriteria": [
        "DELETE /api/clans/{id}/members/{user_id}",
        "Only owner can remove",
        "Cannot remove self (owner)",
        "Removes from clan_members and user_clans",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-024",
      "title": "Edit Clan (Owner)",
      "description": "As a clan owner, I want to edit clan name/description/emoji so I can update group info.",
      "acceptanceCriteria": [
        "PUT /api/clans/{id} accepts {name, description, emoji}",
        "Only owner can edit global settings",
        "Updates clan hash",
        "Typecheck passes"
      ],
      "priority": 24,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-025",
      "title": "Delete Clan",
      "description": "As a clan owner, I want to delete a clan so I can remove the group entirely.",
      "acceptanceCriteria": [
        "DELETE /api/clans/{id}",
        "Only owner can delete",
        "Removes clan hash, clan_members, clan_feed",
        "Removes clan from all user_clans",
        "Archives content (marks as deleted, doesn't purge)",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-026",
      "title": "Personalize Clan Name/Emoji",
      "description": "As a user, I want to rename a clan and change its emoji for my view only.",
      "acceptanceCriteria": [
        "PUT /api/clans/{id}/personalize accepts {name, emoji}",
        "Stores in user_clan_personal hash",
        "Does not affect other users' views",
        "Typecheck passes"
      ],
      "priority": 26,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-027",
      "title": "Enforce Clan Limits",
      "description": "As a developer, I need to enforce limits of 10 clans per user and 50 members per clan.",
      "acceptanceCriteria": [
        "Create clan checks user_clans count < 10",
        "Invite/join checks clan_members count < 50",
        "Returns 400 with clear error message when limit reached",
        "Typecheck passes"
      ],
      "priority": 27,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-028",
      "title": "Create Post API Endpoint",
      "description": "As a user, I want to create a post so I can share content with my clans.",
      "acceptanceCriteria": [
        "POST /api/posts accepts {content, clan_ids, tags}",
        "Validates user is member of all clan_ids",
        "Creates post hash with auto-tags (posted_by, media_type)",
        "Adds to clan_feed sorted sets for each clan_id",
        "Adds to user_posts and type_posts sorted sets",
        "Returns post_id",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-029",
      "title": "Upload Media with Post",
      "description": "As a user, I want to upload photos/videos with my post so I can share media.",
      "acceptanceCriteria": [
        "POST /api/posts/upload returns presigned S3 URL",
        "Accepts file metadata (type, size)",
        "Limit: up to 20 photos per post",
        "Returns media URLs to include in post content",
        "Typecheck passes"
      ],
      "priority": 29,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-030",
      "title": "Get Single Post",
      "description": "As a user, I want to view a single post so I can see its full content.",
      "acceptanceCriteria": [
        "GET /api/posts/{id}",
        "Validates user is member of at least one post clan_id",
        "Returns post with clan_metadata (personalized names/emojis)",
        "Typecheck passes"
      ],
      "priority": 30,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-031",
      "title": "Delete Post",
      "description": "As a user, I want to delete my post so I can remove content I've shared.",
      "acceptanceCriteria": [
        "DELETE /api/posts/{id}",
        "Only post owner can delete",
        "Removes from all clan_feed sorted sets",
        "Removes from user_posts, type_posts sorted sets",
        "Marks post hash as deleted",
        "Typecheck passes"
      ],
      "priority": 31,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-032",
      "title": "Add Comment to Post",
      "description": "As a user, I want to comment on a post so I can discuss content with clan members.",
      "acceptanceCriteria": [
        "POST /api/posts/{id}/comments accepts {text}",
        "Validates user is member of at least one post clan_id",
        "Creates comment hash",
        "Replicates to post_comments for ALL post clan_ids",
        "Triggers notification",
        "Typecheck passes"
      ],
      "priority": 32,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-033",
      "title": "Get Post Comments",
      "description": "As a user, I want to see comments on a post so I can read the discussion.",
      "acceptanceCriteria": [
        "GET /api/posts/{id}/comments",
        "Returns comments visible to user (from clans they belong to)",
        "Sorted chronologically",
        "Includes commenter info",
        "Typecheck passes"
      ],
      "priority": 33,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-034",
      "title": "Add Reaction to Post",
      "description": "As a user, I want to react to a post with an emoji so I can express my feelings.",
      "acceptanceCriteria": [
        "POST /api/posts/{id}/reactions accepts {emoji}",
        "Validates user is member of at least one post clan_id",
        "Stores in post_reactions hash",
        "Replicates to ALL post clan_ids",
        "One reaction per user per post (overwrites previous)",
        "Triggers notification",
        "Typecheck passes"
      ],
      "priority": 34,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-035",
      "title": "Get Post Reactions",
      "description": "As a user, I want to see reactions on a post so I can see how others feel.",
      "acceptanceCriteria": [
        "GET /api/posts/{id}/reactions",
        "Returns aggregated reaction counts by emoji",
        "Returns user's own reaction if present",
        "Typecheck passes"
      ],
      "priority": 35,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-036",
      "title": "Tag Members in Post",
      "description": "As a user, I want to @mention clan members so they get notified.",
      "acceptanceCriteria": [
        "POST /api/posts accepts tags array with @mentions",
        "Validates mentioned users are members of at least one target clan",
        "Triggers tag notification to mentioned users",
        "Typecheck passes"
      ],
      "priority": 36,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-037",
      "title": "Search Posts by Tags",
      "description": "As a user, I want to search posts by #hashtags so I can find related content.",
      "acceptanceCriteria": [
        "GET /api/search accepts {query, clan_id, from_date, to_date}",
        "Searches hashtags within user's clans",
        "Applies date filter using sorted set range queries",
        "Returns deduplicated results with clan badges",
        "Typecheck passes"
      ],
      "priority": 37,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-038",
      "title": "Get Combined Feed",
      "description": "As a user, I want a combined feed of all my clans so I can see everything at once.",
      "acceptanceCriteria": [
        "GET /api/feeds/combined accepts {page, limit}",
        "Aggregates posts from all user_clans using zunionstore",
        "Sorted by created_at DESC",
        "Deduplicates multi-clan posts (show once with multi-clan indicator)",
        "Includes clan_metadata with personalized names/emojis",
        "Typecheck passes"
      ],
      "priority": 38,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-039",
      "title": "Get Single Clan Feed",
      "description": "As a user, I want to view a single clan's feed so I can focus on one group.",
      "acceptanceCriteria": [
        "GET /api/feeds/clan/{id} accepts {page, limit}",
        "Validates user is clan member",
        "Returns posts from clan_feed sorted set",
        "Sorted by created_at DESC",
        "Typecheck passes"
      ],
      "priority": 39,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-040",
      "title": "Feed Deduplication Logic",
      "description": "As a developer, I need to deduplicate multi-clan posts in combined feed.",
      "acceptanceCriteria": [
        "Posts appearing in multiple user clans show once",
        "Multi-clan indicator shows \"In X clans\" count",
        "Expandable to show all clan names",
        "Uses post_id grouping in feed aggregation",
        "Typecheck passes"
      ],
      "priority": 40,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-041",
      "title": "Get All Media View",
      "description": "As a user, I want an \"All Photos\" view so I can easily find media across clans.",
      "acceptanceCriteria": [
        "GET /api/feeds/media accepts {page, limit, clan_id}",
        "Filters type_posts:photo and type_posts:video",
        "Deduplicates across clans",
        "Returns with clan source badges",
        "Typecheck passes"
      ],
      "priority": 41,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-042",
      "title": "Register Device Token",
      "description": "As a user, I want to register my device so I can receive push notifications.",
      "acceptanceCriteria": [
        "POST /api/notifications/register accepts {device_token, platform}",
        "Stores in user_devices set",
        "Supports multiple devices per user",
        "Typecheck passes"
      ],
      "priority": 42,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-043",
      "title": "Update Notification Preferences",
      "description": "As a user, I want to configure notifications per clan so I control what alerts I receive.",
      "acceptanceCriteria": [
        "PUT /api/notifications/settings accepts {clan_id, triggers: {posts, photos, tags, comments, reactions}}",
        "Stores in user_prefs hash",
        "Supports global enable/disable toggle",
        "Typecheck passes"
      ],
      "priority": 43,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-044",
      "title": "Get Notification Preferences",
      "description": "As a user, I want to view my notification settings so I can see current configuration.",
      "acceptanceCriteria": [
        "GET /api/notifications/settings",
        "Returns all clan preferences",
        "Returns global enabled status",
        "Typecheck passes"
      ],
      "priority": 44,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-045",
      "title": "Trigger New Post Notification",
      "description": "As a developer, I need to send push notifications when new posts are created.",
      "acceptanceCriteria": [
        "On post create, check notification prefs for all clan members",
        "Send FCM push to users with posts=true for that clan",
        "Include preview text: \"New post in {clan_name} by {user}\"",
        "Typecheck passes"
      ],
      "priority": 45,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-046",
      "title": "Trigger Comment Notification",
      "description": "As a developer, I need to send push notifications for comments on user's posts.",
      "acceptanceCriteria": [
        "On comment create, notify post owner",
        "Check notification prefs (comments=true)",
        "Include preview: \"{user} commented on your post\"",
        "Typecheck passes"
      ],
      "priority": 46,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-047",
      "title": "Trigger Tag/Mention Notification",
      "description": "As a developer, I need to send push notifications when users are @mentioned.",
      "acceptanceCriteria": [
        "On tag, notify mentioned user",
        "Check notification prefs (tags=true)",
        "Include preview: \"{user} mentioned you in {clan_name}\"",
        "Typecheck passes"
      ],
      "priority": 47,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-048",
      "title": "Trigger Reaction Notification",
      "description": "As a developer, I need to send push notifications for reactions on user's posts.",
      "acceptanceCriteria": [
        "On reaction, notify post owner",
        "Check notification prefs (reactions=true)",
        "Include preview: \"{user} reacted {emoji} to your post\"",
        "Typecheck passes"
      ],
      "priority": 48,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-049",
      "title": "Deduplicate Multi-Clan Notifications",
      "description": "As a developer, I need to send only one notification for multi-clan events.",
      "acceptanceCriteria": [
        "When event spans multiple clans user belongs to, send single notification",
        "Notification text notes: \"in {clan_name} +{count} clans\"",
        "Uses notification dedup key based on event_id + user_id",
        "Typecheck passes"
      ],
      "priority": 49,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-050",
      "title": "Unregister Device Token",
      "description": "As a user, I want to unregister my device when I log out so I stop receiving notifications.",
      "acceptanceCriteria": [
        "DELETE /api/notifications/unregister accepts {device_token}",
        "Removes from user_devices set",
        "Typecheck passes"
      ],
      "priority": 50,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-051",
      "title": "Initialize Next.js Frontend Project",
      "description": "As a developer, I need a Next.js frontend project for the mobile app UI.",
      "acceptanceCriteria": [
        "Next.js 14+ project with App Router",
        "Tailwind CSS configured",
        "TypeScript configured",
        "Typecheck passes"
      ],
      "priority": 51,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-052",
      "title": "Configure Capacitor for Native Mobile",
      "description": "As a developer, I need Capacitor configured to wrap the app as native iOS/Android.",
      "acceptanceCriteria": [
        "Capacitor installed and initialized",
        "iOS and Android platforms added",
        "Push notifications plugin configured (@capacitor/push-notifications)",
        "Camera plugin for media uploads (@capacitor/camera)",
        "Typecheck passes"
      ],
      "priority": 52,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-053",
      "title": "Implement Authentication UI",
      "description": "As a user, I want login/signup screens so I can access the app.",
      "acceptanceCriteria": [
        "Login page with email/password",
        "Signup page with email/password",
        "JWT stored securely (capacitor secure storage)",
        "Redirects to feed on success",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 53,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-054",
      "title": "Implement Clan List UI",
      "description": "As a user, I want to see my clans list so I can navigate between groups.",
      "acceptanceCriteria": [
        "Displays all user's clans with personalized names/emojis",
        "Shows member count per clan",
        "Tap to navigate to clan feed",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 54,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-055",
      "title": "Implement Create Clan UI",
      "description": "As a user, I want a form to create a new clan so I can start a group.",
      "acceptanceCriteria": [
        "Form with name, description (optional), emoji picker",
        "Submit calls POST /api/clans",
        "Success navigates to new clan",
        "Error shows limit message if at 10 clans",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 55,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-056",
      "title": "Implement Clan Settings UI",
      "description": "As a user, I want to view and edit clan settings so I can manage my group.",
      "acceptanceCriteria": [
        "Shows clan name, description, emoji, member list",
        "Owner sees edit/delete options",
        "All members see personalize option",
        "Leave button for non-owners",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 56,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-057",
      "title": "Implement Invite Members UI",
      "description": "As a clan owner, I want to invite members via email or share link.",
      "acceptanceCriteria": [
        "Email input for invites",
        "Share button generates invite link",
        "QR code display for in-person invites",
        "Shows pending invites",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 57,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-058",
      "title": "Implement Personalize Clan UI",
      "description": "As a user, I want to personalize clan name and emoji for my view.",
      "acceptanceCriteria": [
        "Edit button opens modal",
        "Name input with current personalized or global value",
        "Emoji picker (standard set with search)",
        "Confirm message: \"This changes only for you\"",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 58,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-059",
      "title": "Implement Combined Feed UI",
      "description": "As a user, I want to see a combined feed of all my clans.",
      "acceptanceCriteria": [
        "Chronological list of posts from all clans",
        "Each post shows clan badge with personalized name/emoji",
        "Multi-clan posts show \"In X clans\" indicator",
        "Infinite scroll pagination",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 59,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-060",
      "title": "Implement Single Clan Feed UI",
      "description": "As a user, I want to view a single clan's feed.",
      "acceptanceCriteria": [
        "Tab or dropdown to select clan",
        "Shows only posts from selected clan",
        "Clan header with name, emoji, member count",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 60,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-061",
      "title": "Implement Compose Post UI",
      "description": "As a user, I want to create a new post with text and media.",
      "acceptanceCriteria": [
        "Text input (up to 1000 chars)",
        "Media picker (up to 20 photos)",
        "Clan selector with checkboxes and emojis",
        "Preview shows \"Visible to: Clan A, Clan B\"",
        "Submit creates post",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 61,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-062",
      "title": "Implement Post Detail UI",
      "description": "As a user, I want to view a post's full content and comments.",
      "acceptanceCriteria": [
        "Shows post content, media, author, timestamp",
        "Shows clan badges for multi-clan posts",
        "Comments section with threaded replies",
        "Reaction bar with emoji options",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 62,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-063",
      "title": "Implement Comment Input UI",
      "description": "As a user, I want to add comments to posts.",
      "acceptanceCriteria": [
        "Text input at bottom of post detail",
        "Submit adds comment",
        "Shows \"Commenting in all clans\" for multi-clan posts",
        "New comment appears immediately",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 63,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-064",
      "title": "Implement Reactions UI",
      "description": "As a user, I want to react to posts with emojis.",
      "acceptanceCriteria": [
        "Reaction bar below post",
        "Tap to add/change reaction",
        "Shows reaction counts",
        "Highlights user's own reaction",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 64,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-065",
      "title": "Implement All Media View UI",
      "description": "As a user, I want to browse all photos across my clans.",
      "acceptanceCriteria": [
        "Grid view of media",
        "Filter by clan",
        "Shows clan source badge on each item",
        "Tap to open full post",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 65,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-066",
      "title": "Implement Search UI",
      "description": "As a user, I want to search posts by hashtags.",
      "acceptanceCriteria": [
        "Search input at top",
        "Results show matching posts",
        "Filter by clan and date range",
        "Shows clan badges on results",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 66,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-067",
      "title": "Implement Notification Settings UI",
      "description": "As a user, I want to configure my push notification preferences.",
      "acceptanceCriteria": [
        "Global enable/disable toggle",
        "Per-clan accordion with trigger toggles",
        "Triggers: posts, photos, tags, comments, reactions",
        "Saves on change",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 67,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-068",
      "title": "Implement Push Notification Handling",
      "description": "As a user, I want to receive and handle push notifications.",
      "acceptanceCriteria": [
        "Registers device token on app launch",
        "Requests notification permission",
        "Tap notification opens relevant post/clan",
        "Unregisters on logout",
        "Typecheck passes"
      ],
      "priority": 68,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-069",
      "title": "Implement Threaded Comments with Rich Text",
      "description": "As a user, I want to reply to comments in threads with rich text formatting so I can have structured discussions.",
      "acceptanceCriteria": [
        "Comments support threaded replies up to 5 levels deep",
        "Rich text support: emojis and links in comment text",
        "Comment hash stores parent_comment_id for threading",
        "GET /api/posts/{id}/comments returns nested thread structure",
        "UI displays threaded replies with indentation",
        "Typecheck passes"
      ],
      "priority": 69,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-070",
      "title": "Add Multi-Clan Comment Origin Indicator",
      "description": "As a user, I want to see where comments originated when viewing multi-clan posts so I understand the context.",
      "acceptanceCriteria": [
        "Comments on multi-clan posts show origin indicator in UI",
        "Indicator shows \"Commented in {clan_name}\" or \"From combined view\"",
        "Comment hash stores origin_clan_id or combined_view flag",
        "GET /api/posts/{id}/comments includes origin metadata",
        "UI displays origin indicator next to comment",
        "Typecheck passes"
      ],
      "priority": 70,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-071",
      "title": "Replicate Tags Across Multi-Clan Posts",
      "description": "As a developer, I need tags to be replicated across all clans when a post is assigned to multiple clans.",
      "acceptanceCriteria": [
        "When post is created with multiple clan_ids, tags are visible in all assigned clans",
        "Tag search returns results from all clans where post is visible",
        "Tags stored in post hash are accessible across all post clan_ids",
        "GET /api/search returns tags from multi-clan posts in all relevant clans",
        "Tag notifications respect clan membership visibility",
        "Typecheck passes"
      ],
      "priority": 71,
      "passes": true,
      "notes": "Implemented via existing architecture: tags stored in post hash (not per-clan), posts in all clan feeds, search/feeds include all clan badges where user is member, notifications use isInClan checks"
    },
    {
      "id": "US-072",
      "title": "Implement Member Permissions Structure",
      "description": "As a developer, I need to store permissions per clan member so I can control what actions they can perform.",
      "acceptanceCriteria": [
        "Permissions stored in hash: `clan_member_roles:{clan_id}:{user_id}`",
        "Permissions JSON structure: {post: true, comment: true}",
        "Default permissions for members: {post: true, comment: true}",
        "Default permissions for owner: {post: true, comment: true, admin: true}",
        "Helper functions to check permissions before actions",
        "POST /api/posts validates post permission before creating",
        "POST /api/posts/{id}/comments validates comment permission",
        "Typecheck passes"
      ],
      "priority": 72,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-073",
      "title": "Add Members to Clan Endpoint",
      "description": "As a clan owner, I want to directly add members to my clan so I can manage membership.",
      "acceptanceCriteria": [
        "POST /api/clans/{id}/members accepts {user_ids} array",
        "Only owner can add members",
        "Validates user_ids exist and are not already members",
        "Enforces 50 members per clan limit",
        "Adds users to clan_members set",
        "Adds clan to each user's user_clans set",
        "Sets default permissions {post: true, comment: true}",
        "Sets default notification preferences (all true)",
        "Returns success status",
        "Typecheck passes"
      ],
      "priority": 73,
      "passes": true,
      "notes": ""
    }
  ]
}
